<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Résultat</title>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
</head>
<body>
    <h1>Il y a {{nbRes}} résultats !</h1>

    <table id="données">
        % for item in res:
            <tr class="row">
                <td>{{item[0]}}</td>
                <td>{{item[1]}}</td>
                <td>{{item[2]}}</td>
                <td>{{item[3]}}</td>
                <td>{{item[4]}}</td>
            </tr>
        % end
    </table>
<div id="map" style="width:600px; height:400px;margin:0 auto;"></div>
<script>
var myLatlng;
var map;
var mapOptions;
function initMap() {
    myLatlng = new google.maps.LatLng(47.215376,-1.550337);

    mapOptions = {
        zoom: 8,
        center: myLatlng
    };

    map = new google.maps.Map(document.getElementById("map"), mapOptions);

        var labels = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';

        var markers = locations.map(function(location, i) {
          return new google.maps.Marker({
            position: location,
            label: labels[i % labels.length]
          });
        });

        var markerCluster = new MarkerClusterer(map, markers,
            {imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m'});
}

  var tabLat = new Array();
  var tabLng = new Array();
  var locations = [];
  $(".row").each(function(i, data) {
     locations.push({lat : parseInt(data.children[3].innerHTML,10), lng: parseInt(data.children[4].innerHTML,10)});
  });
      console.log(locations);



</script>

<script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js">
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAE1tBoaXKJJpnSAEEN3LpzAF7p3G6-Zo8&callback=initMap" async defer>
    google.maps.event.addDomListener(window,'load', initMap);
</script>


</body>
</html>